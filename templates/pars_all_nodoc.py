"""
This Script was autogenerated using
``u.create_default_template("pars_all_nodoc.py",2,0)``
It is only a TEMPLATE and not a working reconstruction script.
"""

import numpy as np
import ptypy
from ptypy.core import Ptycho
from ptypy import utils as u

#### Ptypy Parameter Tree ######################################################
p = u.Param()
p.verbose_level = 1
p.data_type = "single"
p.run = None
p.dry_run = False
p.io = u.Param()
p.io.home = "./"
p.io.rfile = "recons/%(run)s/%(run)s_%(engine)s_%(iterations)04d.ptyr"
p.io.autosave = u.Param()
p.io.autosave.active = True
p.io.autosave.interval = 10
p.io.autosave.rfile = "dumps/%(run)s/%(run)s_%(engine)s_%(iterations)04d.ptyr"
p.io.interaction = u.Param()
p.io.interaction.active = True
p.io.interaction.primary_address = "tcp://127.0.0.1"
p.io.interaction.primary_port = 5560
p.io.interaction.port_range = ""5571:5571""
p.io.autoplot = u.Param()
p.io.autoplot.imfile = "plots/%(run)s/%(run)s_%(engine)s_%(iterations)04d.png"
p.io.autoplot.interval = 1
p.io.autoplot.threaded = True
p.io.autoplot.layout = u.Param()
p.io.autoplot.dump = True
p.io.autoplot.make_movie = False
p.scan = u.Param()
p.scan.tags = None
p.scan.if_conflict_use_meta = True
p.scan.data = u.Param()
p.scan.data.recipe = None
p.scan.data.source = None
p.scan.data.dfile = None
p.scan.data.label = None
p.scan.data.shape = None
p.scan.data.save = None
p.scan.data.center = None
p.scan.data.psize = None
p.scan.data.distance = None
p.scan.data.rebin = None
p.scan.data.orientation = None
p.scan.data.energy = None
p.scan.data.min_frames = 1
p.scan.data.num_frames = None
p.scan.data.chunk_format = ".chunk%02d"
p.scan.data.auto_center = None
p.scan.data.load_parallel = "data"
p.scan.data.positions_theory = None
p.scan.data.experimentID = None
p.scan.data.simulation = u.Param()
p.scan.data.simulation.detector = u.Param()
p.scan.data.simulation.psf = None
p.scan.sharing = u.Param()
p.scan.sharing.object_share_with = None
p.scan.sharing.object_share_power = 1
p.scan.sharing.probe_share_with = None
p.scan.sharing.probe_share_power = 1
p.scan.geometry = u.Param()
p.scan.geometry.energy = 6.2
p.scan.geometry.lam = None
p.scan.geometry.distance = 7.19
p.scan.geometry.psize = 0.000172
p.scan.geometry.resolution = None
p.scan.geometry.propagation = "farfield"
p.scan.xy = u.Param()
p.scan.xy.model = None
p.scan.xy.spacing = 1.5e-06
p.scan.xy.steps = 10
p.scan.xy.extent = 1.5e-05
p.scan.xy.offset = 0
p.scan.xy.jitter = 0
p.scan.xy.count = None
p.scan.illumination = u.Param()
p.scan.illumination.model = None
p.scan.illumination.photons = None
p.scan.illumination.recon = u.Param()
p.scan.illumination.recon.rfile = "\*.ptyr"
p.scan.illumination.recon.ID = None
p.scan.illumination.recon.layer = None
p.scan.illumination.stxm = u.Param()
p.scan.illumination.stxm.label = None
p.scan.illumination.aperture = u.Param()
p.scan.illumination.aperture.form = "circ"
p.scan.illumination.aperture.diffuser = None
p.scan.illumination.aperture.size = None
p.scan.illumination.aperture.edge = 2
p.scan.illumination.aperture.central_stop = None
p.scan.illumination.aperture.offset = 0
p.scan.illumination.propagation = u.Param()
p.scan.illumination.propagation.parallel = None
p.scan.illumination.propagation.focussed = None
p.scan.illumination.propagation.antialiasing = 1
p.scan.illumination.propagation.spot_size = None
p.scan.illumination.diversity = u.Param()
p.scan.illumination.diversity.noise = None
p.scan.illumination.diversity.power = 0.1
p.scan.illumination.diversity.shift = None
p.scan.sample = u.Param()
p.scan.sample.model = None
p.scan.sample.fill = 1
p.scan.sample.recon = u.Param()
p.scan.sample.recon.rfile = "\*.ptyr"
p.scan.sample.recon.ID = None
p.scan.sample.recon.layer = None
p.scan.sample.stxm = u.Param()
p.scan.sample.stxm.label = None
p.scan.sample.process = u.Param()
p.scan.sample.process.offset = (0, 0)
p.scan.sample.process.zoom = None
p.scan.sample.process.formula = None
p.scan.sample.process.density = 1
p.scan.sample.process.thickness = 1e-06
p.scan.sample.process.ref_index = (0.5+0j)
p.scan.sample.process.smoothing = 2
p.scan.sample.diversity = u.Param()
p.scan.sample.diversity.noise = None
p.scan.sample.diversity.power = 0.1
p.scan.sample.diversity.shift = None
p.scan.coherence = u.Param()
p.scan.coherence.num_probe_modes = 1
p.scan.coherence.num_object_modes = 1
p.scan.coherence.spectrum = None
p.scan.coherence.object_dispersion = None
p.scan.coherence.probe_dispersion = None
p.scans = u.Param()
p.scans.scan_00 = None
p.engine = u.Param()
p.engine.common = u.Param()
p.engine.common.name = "DM"
p.engine.common.numiter = 2000
p.engine.common.numiter_contiguous = 1
p.engine.common.probe_support = 0.7
p.engine.common.clip_object = None
p.engine.DM = u.Param()
p.engine.DM.alpha = 1
p.engine.DM.probe_update_start = 2
p.engine.DM.update_object_first = True
p.engine.DM.overlap_converge_factor = 0.05
p.engine.DM.overlap_max_iterations = 10
p.engine.DM.probe_inertia = 0.001
p.engine.DM.object_inertia = 0.1
p.engine.DM.fourier_relax_factor = 0.01
p.engine.DM.obj_smooth_std = 20
p.engine.ML = u.Param()
p.engine.ML.type = "gaussian"
p.engine.ML.floating_intensities = False
p.engine.ML.intensity_renormalization = 1
p.engine.ML.reg_del2 = True
p.engine.ML.reg_del2_amplitude = 0.01
p.engine.ML.smooth_gradient = 0
p.engine.ML.scale_precond = False
p.engine.ML.scale_probe_object = 1
p.engine.ML.probe_update_start = 0
p.engines = u.Param()
p.engines.engine_00 = None


Ptycho(p,level=5)
